---
import Reels from "./Reels.astro";

let products = [];
// Fetch productos
try {
  const response = await fetch(
    "https://admin.jewelryfashionoficial.com/wp-json/custom-api/v1/api-json/v1/get_products/home/?nocache=12345"
  );

  products = await response.json();
} catch (err) {
  console.error("Error loading related products:", err);
}

// Cargar categorías
let categories = [];

try {
  const response = await fetch(
    "https://admin.jewelryfashionoficial.com/wp-json/custom-api/v1/api-json/v1/get_categories/?nocache=53244"
  );
  categories = await response.json();
} catch (err) {
  console.error("Error loading categories:", err);
}
---

<div title="Jewelryfashion Oficial">
  <main class="relative h-screen w-full overflow-hidden">
    <div class="absolute inset-0 z-0">
      <!-- <img
        src="https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=2070&auto=format&fit=crop"
        alt="Background woman looking back"
        class="w-full h-full object-cover object-center"
      /> -->
      <video
        src="/src/assets/video1.mp4"
        autoplay
        muted
        loop
        class="w-full h-full object-cover backdrop-blur-2xl filter brightness-50 bg-black/10 object-center"
      ></video>

      <div class="absolute inset-0 bg-black/10"></div>

      <div
        class="absolute inset-0 bg-gradient-to-t from-[#1a1a1a] via-[#1a1a1a]/40 to-transparent bottom-0 h-full"
      >
      </div>

      <div
        class="absolute inset-0 bg-gradient-to-r from-black/30 via-transparent to-black/30"
      >
      </div>
    </div>

    <div
      class="relative z-10 flex flex-col items-center justify-center h-full text-center px-4 pt-20"
    >
      <h1
        class="text-5xl md:text-7xl font-semibold tracking-tight text-white mb-6 leading-tight max-w-4xl drop-shadow-lg"
      >
        Todo lo que necesita tu negocio en joyería!<br />
      </h1>

      <p
        class="text-lg md:text-xl text-gray-200 mb-10 max-w-2xl font-normal leading-relaxed drop-shadow-md"
      >
        +500 diseños exclusivos. <span class="text-white font-semibold"
          >Oro, plata y platino.</span
        >
        Eleva tu estilo diario sin gastar una fortuna. Piezas de calidad.
      </p>

      <div class="flex flex-col items-center gap-4">
        <button
          id="callToAction"
          class="group bg-[#A40000] hover:bg-[#850000] cursor-pointer text-white text-lg font-semibold px-10 py-4 rounded-full transition-all shadow-[0_0_20px_rgba(255,92,53,0.3)] hover:shadow-[0_0_30px_rgba(255,92,53,0.5)] flex items-center gap-2"
        >
          Adquirir ahora
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="transition-transform group-hover:translate-x-1"
            ><path d="m9 18 6-6-6-6"></path></svg
          >
        </button>

        <div
          class="flex items-center gap-2 text-white/90 text-sm font-medium mt-2"
        >
          <div class="border border-white/50 rounded-full p-0.5">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="12"
              height="12"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="3"
              stroke-linecap="round"
              stroke-linejoin="round"
              ><polyline points="20 6 9 17 4 12"></polyline></svg
            >
          </div>
          <span>ASTM-F136 ~ 316L</span>
        </div>
      </div>
    </div>
  </main>
</div>

<div class="flex min-h-screen w-full flex-col">
  <main class="flex-1">
    <div class="mt-12">
      <h1
        class="text-center text-2xl md:text-4xl font-semibold tracking-tight text-white mb-6 leading-tight drop-shadow-lg"
      >
        Algunos de nuestros productos
      </h1>
    </div>
    <div class="@container">
      <div class="@[480px]:p-4">
        <div class="relative min-h-[40vh] overflow-hidden @[480px]:rounded-xl">
          <div class="absolute inset-0 flex">
            <div
              class="h-full w-full flex-shrink-0 bg-cover bg-center bg-no-repeat"
              data-alt="Close-up of a person with elegant ear piercings wearing gold jewelry."
              style='background-image: linear-gradient(rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0.5) 100%), url("https://lh3.googleusercontent.com/aida-public/AB6AXuD47kH2z--Fmp1lx-r_EgQRB4SY_8Ang7hPmcP3cntoc2XHkNaCTpcrtZx3hrHndROIFLGbE50-ZDHcMzQYty45K62QwkZKbja1ATbus1An9rQRa7N0JUigK78rKxWdzdKQCEA4EC58eQWmGTxEDgKO8JryFDu7wN96ghG-YTOMjppLgpkuyq69WFWKM2qZ6_tNHFKtZhfSskFgptHaKR7IR33kDeBtOUELTKaVXBWNbxY46sMcjui9Jy-1z5Nj1BcawDDUEc-k3t4");'
            >
            </div>
            <div
              class="h-full w-full flex-shrink-0 bg-cover bg-center bg-no-repeat"
              data-alt="A luxurious gold piercing with intricate details against a dark backdrop."
              style='background-image: linear-gradient(rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0.5) 100%), url("https://lh3.googleusercontent.com/aida-public/AB6AXuCLxt4XNb3Fm6wv_Lp04a07yOgeePFY3oCg3G1qrDfw-ZrlnuwU0LUZReftrzz8zK7yMX6OfB02nha0lxS4vrrKcnuUbHJKFW5NGJ0lsH_Uj7nm_0ZVgx4wLPHutd_n2L_JxvicshscjHvWwoByduTT44sCQ3k3e-m1YuywC60hD8aFKwXBoWeDjMUdrELD5-Uv-JpfrnYUUVifBoe8p7j3DexpJ6GYRtYpczlVPqiVQ5Zesr04frrtuWEe_tUUp8aCH9FZ1X1eKpg");'
            >
            </div>
            <div
              class="h-full w-full flex-shrink-0 bg-cover bg-center bg-no-repeat"
              data-alt="A person showcasing a stylish nose piercing."
              style='background-image: linear-gradient(rgba(0, 0, 0, 0.2) 0%, rgba(0, 0, 0, 0.5) 100%), url("https://lh3.googleusercontent.com/aida-public/AB6AXuDczgim3KXYTXwBTobhB_kGoGH2o28Gu35BkXss_c6VQhODWQao-HqolVqBZJ425L3aTvYnK3HUv35mC5wZ9sB3rRmhQTc8YFD7NO7rVM0OcfUVyyjed9vQACv3D7SRWkO2sisD7wG29qzSOIXSexCmPs-mzOvSUsuAmY98p6UBf9J1CfCi2zpkFsDEngU2xlvXyQyDNthpf7TsPdPhhc5xi6Y0kXNsUcU6ygLC0v933gLHJjga_ESzph3DamE4-xmNQDKmc4EXh8o");'
            >
            </div>
          </div>

          <div
            class="absolute inset-0 flex flex-col items-center justify-center gap-6 p-4 text-center @[480px]:gap-8"
          >
            <div class="flex max-w-2xl flex-col gap-2">
              <h1
                class="text-4xl font-black leading-tight tracking-[-0.033em] text-white md:text-6xl @[480px]:font-black @[480px]:leading-tight @[480px]:tracking-[-0.033em]"
              >
                Joyería Premium para Piercings
              </h1>
              <h2
                class="text-sm font-normal leading-normal text-white md:text-lg @[480px]:text-base @[480px]:font-normal @[480px]:leading-normal"
              >
                Descubre diseños únicos que definen tu estilo. Calidad y
                elegancia en cada pieza.
              </h2>
            </div>
            <button
              class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl bg-primary px-4 text-sm font-bold leading-normal tracking-[0.015em] text-white transition-colors h-10 hover:bg-primary/90 @[480px]:h-12 @[480px]:px-5 @[480px]:text-base @[480px]:font-bold @[480px]:leading-normal @[480px]:tracking-[0.015em]"
            >
              <span class="truncate">Ver Colección</span>
            </button>
          </div>
          <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2">
            <button class="h-2.5 w-2.5 rounded-full bg-white opacity-90"
            ></button>
            <button
              class="h-2.5 w-2.5 rounded-full bg-white opacity-40 hover:opacity-60"
            ></button>
            <button
              class="h-2.5 w-2.5 rounded-full bg-white opacity-40 hover:opacity-60"
            ></button>
          </div>
          <button
            class="absolute left-2 top-1/2 -translate-y-1/2 rounded-full bg-black/30 p-2 text-white transition-colors hover:bg-black/50 @[480px]:left-4"
          >
            <span class="material-symbols-outlined">chevron_left</span>
          </button>
          <button
            class="absolute right-2 top-1/2 -translate-y-1/2 rounded-full bg-black/30 p-2 text-white transition-colors hover:bg-black/50 @[480px]:right-4"
          >
            <span class="material-symbols-outlined">chevron_right</span>
          </button>
        </div>
      </div>
    </div>

    <div class="p-4 @container">
      <div
        class="flex flex-1 flex-col items-start justify-between gap-4 rounded-xl border border-primary/20 bg-background-light p-5 shadow-lg shadow-black/10 dark:border-[#533c3c] dark:bg-[#211111] @[480px]:flex-row @[480px]:items-center"
      >
        <div class="flex flex-col gap-1">
          <p
            class="text-base font-bold leading-tight text-black dark:text-white"
          >
            Envío Gratis
          </p>
          <p
            class="text-base font-normal leading-normal text-gray-600 dark:text-[#b89d9d]"
          >
            En todos los pedidos superiores a 50€
          </p>
        </div>
        <a
          class="flex items-center gap-2 text-sm font-bold leading-normal tracking-[0.015em] text-primary hover:underline dark:text-white"
          href="#"
        >
          Saber más
          <span class="material-symbols-outlined text-lg">arrow_forward</span>
        </a>
      </div>
    </div>

    <Reels />

    <!-- --------------------------------------------------- -->
    <h2
      class="px-4 pb-3 pt-5 text-[22px] font-bold leading-tight tracking-[-0.015em] text-black dark:text-white"
    >
      Productos
    </h2>
    <div class="grid grid-cols-2 gap-4 p-4 md:grid-cols-4">
      {
        products.map((product: any) => (
          <div class="flex flex-col gap-3">
            <div
              class="relative w-full bg-center bg-no-repeat aspect-square bg-cover rounded-xl bg-[#2B0001]"
              data-alt={product.product_name}
              style={`background-image: url("${product.image_url}");`}
            >
              {product.on_sale ? (
                <div class="absolute top-2 left-2 bg-primary text-white text-[10px] font-bold px-2 py-0.5 rounded-full">
                  OFERTA
                </div>
              ) : null}
            </div>
            <div class="flex flex-col gap-2">
              <div>
                <p class="text-white text-sm font-semibold leading-tight">
                  {product.product_name}
                </p>
                <p class="text-gray-400 text-xs font-normal leading-normal">
                  {product.material}
                </p>
              </div>
              <div class="flex items-center gap-2 flex-wrap">
                <p class="text-white text-sm font-bold leading-normal">
                  ${product.price}
                </p>
                {product.on_sale ? (
                  <p class="text-gray-500 text-xs font-normal leading-normal line-through">
                    ${product.regular_price}
                  </p>
                ) : null}
              </div>
              <div class="flex flex-col gap-2">
                <button
                  id={`add-to-cart-btn-${product.id}`}
                  data-product={encodeURIComponent(
                    JSON.stringify(product || {})
                  )}
                  class="flex cursor-pointer w-full items-center justify-center gap-x-2 rounded-lg bg-[#480001] px-3 py-1.5 text-white text-xs font-bold leading-normal"
                >
                  <span class="material-symbols-outlined text-base">
                    add_shopping_cart
                  </span>
                  Agregar
                </button>
                <a
                  href={product.product_link + product.id}
                  class="hidden md:flex w-full items-center justify-center gap-x-2 rounded-lg bg-primary px-3 py-1.5 text-white text-xs font-bold leading-normal"
                >
                  Ver
                </a>
              </div>
            </div>
          </div>
        ))
      }
    </div>

    <h2
      class="px-4 pb-3 pt-8 text-[22px] font-bold leading-tight tracking-[-0.015em] text-black dark:text-white"
    >
      Explora Nuestras Categorías
    </h2>
    <div class="grid grid-cols-2 gap-4 p-4 md:grid-cols-3">
      {
        categories.map((category: any) => (
          <a
            class="group relative flex h-48 items-center justify-center overflow-hidden rounded-xl shadow-lg md:h-64"
            href={"category/" + category.id}
          >
            <div
              class="absolute inset-0 bg-cover bg-center bg-no-repeat transition-transform duration-500 group-hover:scale-110"
              data-alt="Close-up of a curated ear with multiple piercings."
              style={`background-image: url("${category.image_url}");`}
            />
            <div class="absolute inset-0 bg-black/50" />
            <h3 class="relative text-xl font-bold text-white">
              {category.name}
            </h3>
          </a>
        ))
      }
    </div>
  </main>
</div>

<script>
  window.addEventListener("DOMContentLoaded", () => {
    const callToAction = document.getElementById("callToAction");
    if (callToAction) {
      callToAction.addEventListener("click", () => {
        window.location.href = window.location.href + "catalog";
      });
    }
  });
</script>

<!-- <script>
  const urlHost = window.location.host;
  const isLocalhost = urlHost && urlHost.includes("localhost");
  if (!isLocalhost) {
    window.location.href = "/maintance";
  }
</script> -->
